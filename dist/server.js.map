{"version":3,"file":"server.js","mappings":"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","sources":["webpack://NodeMonkey/webpack/universalModuleDefinition","webpack://NodeMonkey/./src/lib/common-utils.js","webpack://NodeMonkey/./src/lib/cycle.js","webpack://NodeMonkey/./src/server/bunyan-stream.js","webpack://NodeMonkey/./src/server/command-interface.js","webpack://NodeMonkey/./src/server/command-manager.js","webpack://NodeMonkey/./src/server/setup-server.js","webpack://NodeMonkey/./src/server/setup-socket.js","webpack://NodeMonkey/./src/server/ssh-manager.js","webpack://NodeMonkey/./src/server/user-manager.js","webpack://NodeMonkey/./src/server/utils.js","webpack://NodeMonkey/external commonjs \"@babel/runtime/helpers/asyncToGenerator\"","webpack://NodeMonkey/external commonjs \"@babel/runtime/helpers/classCallCheck\"","webpack://NodeMonkey/external commonjs \"@babel/runtime/helpers/createClass\"","webpack://NodeMonkey/external commonjs \"@babel/runtime/helpers/defineProperty\"","webpack://NodeMonkey/external commonjs \"@babel/runtime/helpers/typeof\"","webpack://NodeMonkey/external commonjs \"@babel/runtime/regenerator\"","webpack://NodeMonkey/external commonjs \"events\"","webpack://NodeMonkey/external commonjs \"keypair\"","webpack://NodeMonkey/external commonjs \"lodash\"","webpack://NodeMonkey/external commonjs \"minimist\"","webpack://NodeMonkey/external commonjs \"node-pty\"","webpack://NodeMonkey/external commonjs \"scrypt-kdf\"","webpack://NodeMonkey/external commonjs \"socket.io\"","webpack://NodeMonkey/external commonjs \"source-map-support\"","webpack://NodeMonkey/external commonjs \"ssh2\"","webpack://NodeMonkey/external commonjs \"terminal-kit\"","webpack://NodeMonkey/external node-commonjs \"fs\"","webpack://NodeMonkey/external node-commonjs \"fs/promises\"","webpack://NodeMonkey/external node-commonjs \"http\"","webpack://NodeMonkey/external node-commonjs \"os\"","webpack://NodeMonkey/external node-commonjs \"path\"","webpack://NodeMonkey/external node-commonjs \"tty\"","webpack://NodeMonkey/webpack/bootstrap","webpack://NodeMonkey/webpack/runtime/compat get default export","webpack://NodeMonkey/webpack/runtime/define property getters","webpack://NodeMonkey/webpack/runtime/hasOwnProperty shorthand","webpack://NodeMonkey/webpack/runtime/make namespace object","webpack://NodeMonkey/./src/server/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"NodeMonkey\"] = factory();\n\telse\n\t\troot[\"NodeMonkey\"] = factory();\n})(global, () => {\nreturn ","export default {\n  isObject(value) {\n    let type = typeof value\n    return !!value && (type == \"object\" || type == \"function\")\n  },\n\n  invert(obj) {\n    let inverted = {}\n    for (let k in obj) {\n      if (obj.hasOwnProperty(k)) {\n        inverted[obj[k]] = k\n      }\n    }\n\n    return inverted\n  },\n}\n","/*\n    cycle.js\n    2016-05-01\n\n    Public Domain.\n\n    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.\n\n    This code should be minified before deployment.\n    See http://javascript.crockford.com/jsmin.html\n\n    USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO\n    NOT CONTROL.\n*/\n\n/*jslint eval, for */\n\n/*property\n    $ref, decycle, forEach, isArray, keys, length, push, retrocycle, stringify,\n    test\n*/\n\nlet origJSON = global.JSON,\n  JSON = {}\nexport default JSON\n\nif (typeof JSON.decycle !== \"function\") {\n  JSON.decycle = function decycle(object, replacer) {\n    \"use strict\"\n\n    // Make a deep copy of an object or array, assuring that there is at most\n    // one instance of each object or array in the resulting structure. The\n    // duplicate references (which might be forming cycles) are replaced with\n    // an object of the form\n\n    //      {\"$ref\": PATH}\n\n    // where the PATH is a JSONPath string that locates the first occurance.\n\n    // So,\n\n    //      var a = [];\n    //      a[0] = a;\n    //      return JSON.stringify(JSON.decycle(a));\n\n    // produces the string '[{\"$ref\":\"$\"}]'.\n\n    // If a replacer function is provided, then it will be called for each value.\n    // A replacer function receives a value and returns a replacement value.\n\n    // JSONPath is used to locate the unique object. $ indicates the top level of\n    // the object or array. [NUMBER] or [STRING] indicates a child element or\n    // property.\n\n    var objects = [] // Keep a reference to each unique object or array\n    var paths = [] // Keep the path to each unique object or array\n\n    return (function derez(value, path) {\n      // The derez function recurses through the object, producing the deep copy.\n\n      var i // The loop counter\n      var nu // The new object or array\n\n      // If a replacer function was provided, then call it to get a replacement value.\n\n      if (replacer !== undefined) {\n        value = replacer(value)\n      }\n\n      // typeof null === \"object\", so go on if this value is really an object but not\n      // one of the weird builtin objects.\n\n      if (\n        typeof value === \"object\" &&\n        value !== null &&\n        !(value instanceof Boolean) &&\n        !(value instanceof Date) &&\n        !(value instanceof Number) &&\n        !(value instanceof RegExp) &&\n        !(value instanceof String)\n      ) {\n        // If the value is an object or array, look to see if we have already\n        // encountered it. If so, return a {\"$ref\":PATH} object. This is a hard\n        // linear search that will get slower as the number of unique objects grows.\n        // Someday, this should be replaced with an ES6 WeakMap.\n\n        i = objects.indexOf(value)\n        if (i >= 0) {\n          return { $ref: paths[i] }\n        }\n\n        // Otherwise, accumulate the unique value and its path.\n\n        objects.push(value)\n        paths.push(path)\n\n        // If it is an array, replicate the array.\n\n        if (Array.isArray(value)) {\n          nu = []\n          value.forEach(function (element, i) {\n            nu[i] = derez(element, path + \"[\" + i + \"]\")\n          })\n        } else {\n          // If it is an object, replicate the object.\n\n          nu = {}\n          Object.keys(value).forEach(function (name) {\n            nu[name] = derez(value[name], path + \"[\" + JSON.stringify(name) + \"]\")\n          })\n        }\n        return nu\n      }\n      return value\n    })(object, \"$\")\n  }\n}\n\nif (typeof JSON.retrocycle !== \"function\") {\n  JSON.retrocycle = function retrocycle($) {\n    \"use strict\"\n\n    // Restore an object that was reduced by decycle. Members whose values are\n    // objects of the form\n    //      {$ref: PATH}\n    // are replaced with references to the value found by the PATH. This will\n    // restore cycles. The object will be mutated.\n\n    // The eval function is used to locate the values described by a PATH. The\n    // root object is kept in a $ variable. A regular expression is used to\n    // assure that the PATH is extremely well formed. The regexp contains nested\n    // * quantifiers. That has been known to have extremely bad performance\n    // problems on some browsers for very long strings. A PATH is expected to be\n    // reasonably short. A PATH is allowed to belong to a very restricted subset of\n    // Goessner's JSONPath.\n\n    // So,\n    //      var s = '[{\"$ref\":\"$\"}]';\n    //      return JSON.retrocycle(JSON.parse(s));\n    // produces an array containing a single element which is the array itself.\n\n    var px = /^\\$(?:\\[(?:\\d+|\\\"(?:[^\\\\\\\"\\u0000-\\u001f]|\\\\([\\\\\\\"\\/bfnrt]|u[0-9a-zA-Z]{4}))*\\\")\\])*$/\n\n    ;(function rez(value) {\n      // The rez function walks recursively through the object looking for $ref\n      // properties. When it finds one that has a value that is a path, then it\n      // replaces the $ref object with a reference to the value that is found by\n      // the path.\n\n      if (value && typeof value === \"object\") {\n        if (Array.isArray(value)) {\n          value.forEach(function (element, i) {\n            if (typeof element === \"object\" && element !== null) {\n              var path = element.$ref\n              if (typeof path === \"string\" && px.test(path)) {\n                value[i] = eval(path)\n              } else {\n                rez(element)\n              }\n            }\n          })\n        } else {\n          Object.keys(value).forEach(function (name) {\n            var item = value[name]\n            if (typeof item === \"object\" && item !== null) {\n              var path = item.$ref\n              if (typeof path === \"string\" && px.test(path)) {\n                value[name] = eval(path)\n              } else {\n                rez(item)\n              }\n            }\n          })\n        }\n      }\n    })($)\n    return $\n  }\n}\n\nJSON = origJSON\n","import utils from \"./utils\"\n\nconst BUNYAN_TRACE = 10\nconst BUNYAN_DEBUG = 20\nconst BUNYAN_INFO = 30\nconst BUNYAN_WARN = 40\nconst BUNYAN_ERROR = 50\nconst BUNYAN_FATAL = 60\n\nlet levelFromName = {\n  trace: BUNYAN_TRACE,\n  debug: BUNYAN_DEBUG,\n  info: BUNYAN_INFO,\n  warn: BUNYAN_WARN,\n  error: BUNYAN_ERROR,\n  fatal: BUNYAN_FATAL,\n}\nlet nameFromLevel = utils.invert(levelFromName)\n\nexport default (inst) => {\n  return {\n    write: function (rec) {\n      rec = JSON.parse(rec)\n      inst._sendMessage({\n        method: nameFromLevel[rec.level] || \"info\",\n        args: [rec.msg, rec],\n      })\n    },\n  }\n}\n","class CommandInterface {\n  commandManager = null\n\n  write = (val, opts) => {\n    console.log(val)\n  }\n\n  writeLn = (val, opts) => {\n    console.log(val)\n  }\n\n  error = (val, opts) => {\n    console.error(val)\n  }\n\n  prompt = (promptTxt, opts, cb) => {\n    if (typeof opts === \"function\") {\n      cb = opts\n      opts = undefined\n    }\n    opts || (opts = {})\n\n    console.warn(\"Prompt not implemented\")\n  }\n\n  constructor(commandManager, writeFn, writeLnFn, errorFn, promptFn) {\n    this.commandManager = commandManager\n    this.write = writeFn\n    this.writeLn = writeLnFn\n    this.error = errorFn\n    this.prompt = promptFn\n  }\n}\n\nexport default CommandInterface\n","import _ from \"lodash\"\nimport utils from \"./utils\"\nimport minimist from \"minimist\"\n\nclass CommandManager {\n  commands = {}\n\n  addCmd = (cmdName, opts, exec) => {\n    if (this.commands[cmdName]) {\n      throw new Error(`'${cmdName}' is already registered as a command`)\n    }\n\n    if (typeof opts === \"function\") {\n      exec = opts\n      opts = {}\n    }\n\n    this.commands[cmdName] = {\n      opts,\n      exec,\n    }\n  }\n\n  runCmd = async (rawCommand, asUser, io) => {\n    const parsed = utils.parseCommand(rawCommand)\n    const cmdName = parsed[0]\n    const cmd = this.commands[cmdName]\n\n    if (!asUser) {\n      throw new Error(`Missing user context for command '${cmdName}'`)\n    }\n\n    if (!cmd) {\n      throw new Error(`Command not found: '${cmdName}'`)\n    }\n\n    const args = minimist(parsed.slice(1))\n    const doneP = utils.getPromiseObj()\n    const result = cmd.exec(\n      {\n        args,\n        username: asUser,\n      },\n      {\n        write: io.write,\n        writeLn: io.writeLn,\n        error: io.error,\n        prompt: io.prompt,\n      },\n      doneP.resolve,\n    )\n\n    return result.then ? result : doneP.promise\n  }\n}\n\nexport default CommandManager\n","import { extname, } from \"path\"\nimport { createServer, } from \"http\"\nimport { readFile, } from \"fs/promises\"\n\nconst extMap = {\n  html: \"text/html\",\n  js: \"application/javascript\",\n  json: \"application/json\",\n  map: \"application/json\",\n}\n\nconst loadedFiles = new Map()\nasync function loadFile(file) {\n  if (!loadedFiles.has(file)) {\n    loadedFiles.set(file, await readFile(file))\n  }\n  return loadedFiles.get(file)\n}\n\nexport default (options) => {\n  const filePaths = options.filePaths || {}\n  const server = createServer(async (req, res) => {\n    const filePath = filePaths[req.url]\n    if (filePath) {\n      const contentType = extMap[(extname(filePath) || \"\").slice(1)] || \"text/plain\"\n      const content = await loadFile(filePath)\n\n      res.setHeader(\"Content-Type\", contentType)\n      res.writeHead(200)\n      res.end(content)\n    } else {\n      res.writeHead(404)\n      res.end()\n    }\n  })\n\n  return server\n}\n","import _ from \"lodash\"\nimport socketio from \"socket.io\"\nimport CommandInterface from \"./command-interface\"\n\nexport default (options) => {\n  const io = socketio()\n  io.attach(options.server, {\n    path: \"/monkey.io\",\n    autoUnref: true,\n  })\n\n  const ns = io.of(\"/nm\")\n  ns.on(\"connection\", (socket) => {\n    let cmdInterface = null\n    socket.emit(\"settings\", options.clientSettings)\n    socket.emit(\"auth\")\n\n    socket.on(\"auth\", (creds) => {\n      options.userManager\n        .verifyUser(creds.username, creds.password)\n        .then((result) => {\n          socket.emit(\"authResponse\", result, result ? undefined : \"Incorrect password\")\n          if (result) {\n            socket.username = creds.username\n            socket.join(\"authed\")\n            if (options.onAuth) {\n              options.onAuth(socket)\n            }\n          }\n        })\n        .catch((err) => {\n          socket.emit(\"authResponse\", false, err)\n        })\n    })\n\n    socket.on(\"cmd\", (cmdId, command) => {\n      if (!socket.username) {\n        socket.emit(\"cmdResponse\", cmdId, `You are not authorized to run commands`)\n        return\n      }\n\n      if (!cmdInterface) {\n        cmdInterface = createCmdInterface(options.cmdManager, socket)\n      }\n\n      options.cmdManager\n        .runCmd(command, socket.username, cmdInterface)\n        .then((output) => {\n          socket.emit(\"cmdResponse\", cmdId, null, output)\n        })\n        .catch((err) => {\n          socket.emit(\"cmdResponse\", cmdId, (err && err.message) || err, null)\n        })\n    })\n  })\n\n  _.each(options.handlers, function (handler, event) {\n    io.on(event, handler)\n  })\n\n  return ns\n}\n\nfunction createCmdInterface(cmdManager, socket) {\n  let promptId = 0\n  const prompts = {}\n\n  const writeFn = (val, opts) => {\n    if (!val) return\n\n    socket.emit(\"console\", {\n      method: \"log\",\n      args: [val],\n    })\n  }\n\n  const errorFn = (val, opts) => {\n    if (!val) return\n\n    socket.emit(\"console\", {\n      method: \"error\",\n      args: [val],\n    })\n  }\n\n  const promptFn = (promptTxt, opts, cb) => {\n    if (typeof opts === \"function\") {\n      cb = opts\n      opts = undefined\n    }\n    opts || (opts = {})\n\n    let pid = promptId++\n    socket.emit(\"prompt\", pid, promptTxt, opts)\n\n    prompts[pid] = cb\n  }\n\n  socket.on(\"promptResponse\", (promptId, response) => {\n    const cb = prompts[promptId]\n    if (cb) {\n      cb(null, response)\n    }\n  })\n\n  return new CommandInterface(cmdManager, writeFn, writeFn, errorFn, promptFn)\n}\n","import fs from \"fs\"\nimport tty from \"tty\"\nimport { native as nativePty } from \"node-pty\"\nimport ssh2 from \"ssh2\"\nimport termkit from \"terminal-kit\"\nimport CommandInterface from \"./command-interface\"\n\nclass SSHManager {\n  options = {\n    host: \"127.0.0.1\",\n    port: 50501,\n    title: \"Node Monkey\",\n    prompt: \"Node Monkey:\",\n    silent: false,\n  }\n  server\n  clients = new Set()\n\n  constructor(options) {\n    options = Object.assign(this.options, options)\n\n    this.server = new ssh2.Server(\n      {\n        hostKeys: options.hostKeys.map((file) => {\n          return fs.readFileSync(file)\n        }),\n      },\n      this.onClient.bind(this),\n    )\n\n    const monkey = this.options.monkey\n    this.server.listen(options.port, options.host, function () {\n      options.silent || monkey.local.log(`SSH listening on ${this.address().port}`)\n    })\n  }\n\n  shutdown() {\n    const clients = this.clients\n    for (const c of clients) {\n      c.write(\"\\nShutting down\")\n      c.close()\n    }\n  }\n\n  onClient(client) {\n    const { cmdManager, userManager, title, prompt } = this.options\n\n    this.clients.add(\n      new SSHClient({\n        client,\n        cmdManager,\n        userManager,\n        title,\n        prompt,\n        onClose: () => this.clients.delete(client),\n      }),\n    )\n  }\n}\n\nclass SSHClient {\n  constructor(options) {\n    this.options = options\n    this.client = options.client\n    this.cmdInterface = null\n    this.userManager = options.userManager\n    this.session = null\n    this.stream = null\n    this.pty = null\n    this.term = null\n    this.ptyInfo = null\n\n    this.title = options.title\n    this.promptTxt = `${options.prompt} `\n    this.inputActive = false\n    this.cmdHistory = []\n\n    this.username = null\n\n    this.client.on(\"authentication\", this.onAuth.bind(this))\n    this.client.on(\"ready\", this.onReady.bind(this))\n    this.client.on(\"end\", this.onClose.bind(this))\n  }\n\n  _initCmdMan() {\n    const writeFn = (val, opts) => {\n      opts || (opts = {})\n      val || (val = \"\")\n\n      if (opts.bold) {\n        this.term.bold(val)\n      } else {\n        this.term(val)\n      }\n\n      if (opts.newline) {\n        this.term.nextLine()\n      }\n    }\n\n    const writeLnFn = (val, opts) => {\n      opts || (opts = {})\n      opts.newline = true\n      writeFn(val, opts)\n    }\n\n    const errorFn = (val, opts) => {\n      opts || (opts = {})\n\n      // TODO: Apparently by sending this to stdout there is a timing issue and anything sent to\n      //       stdout appears before this value is sent to stderr for some reason.\n      // this.term.red.error(val)\n      this.term.red(val)\n\n      if (opts.newline) {\n        this.term.nextLine()\n      }\n    }\n\n    const promptFn = (promptTxt = \"\", opts, cb) => {\n      if (typeof opts === \"function\") {\n        cb = opts\n        opts = undefined\n      }\n      opts || (opts = {})\n\n      let inputOpts = {}\n      if (opts.hideInput) {\n        inputOpts.echo = false\n      }\n\n      this.term(promptTxt)\n      this.term.inputField(inputOpts, cb)\n    }\n\n    this.cmdInterface = new CommandInterface(this.options.cmdManager, writeFn, writeLnFn, errorFn, promptFn)\n  }\n\n  write(msg, { style = undefined }) {\n    if (this.term) {\n      if (style) {\n        this.term[style](msg)\n      } else {\n        this.term(msg)\n      }\n    }\n  }\n\n  close() {\n    if (this.stream) {\n      this.stream.end()\n    }\n    this.onClose()\n  }\n\n  onAuth(ctx) {\n    if (ctx.method == \"password\") {\n      this.userManager\n        .verifyUser(ctx.username, ctx.password)\n        .then((result) => {\n          if (result) {\n            this.username = ctx.username\n            ctx.accept()\n          } else {\n            ctx.reject()\n          }\n        })\n        .catch((err) => {\n          ctx.reject()\n        })\n    } else if (ctx.method == \"publickey\") {\n      ctx.reject()\n    } else {\n      ctx.reject()\n    }\n  }\n\n  onReady() {\n    this.client.on(\"session\", (accept, reject) => {\n      this.session = accept()\n\n      this.session\n        .once(\"pty\", (accept, reject, info) => {\n          this.ptyInfo = info\n          accept && accept()\n        })\n        .on(\"window-change\", (accept, reject, info) => {\n          Object.assign(this.ptyInfo, info)\n          this._resize()\n          accept && accept()\n        })\n        .once(\"shell\", (accept, reject) => {\n          this.stream = accept()\n          this._initCmdMan()\n          this._initStream()\n          this._initPty()\n          this._initTerm()\n        })\n    })\n  }\n\n  onClose() {\n    let onClose = this.options.onClose\n    onClose && onClose()\n  }\n\n  onKey(name, matches, data) {\n    if (name === \"CTRL_L\") {\n      this.clearScreen()\n    } else if (name === \"CTRL_C\") {\n      this.inputActive = false\n      this.inputField.abort()\n      this.term(\"\\n^^C\\n\")\n      this.prompt()\n    } else if (name === \"CTRL_D\") {\n      let input = this.inputField.getInput()\n      if (!input.length) {\n        this.term.nextLine()\n        setTimeout(() => {\n          this.close()\n        }, 0)\n      }\n    }\n  }\n\n  _resize({ term } = this) {\n    if (term) {\n      term.stdout.emit(\"resize\")\n    }\n  }\n\n  _initStream() {\n    const stream = this.stream\n    stream.name = this.title\n    stream.isTTY = true\n    stream.setRawMode = () => {}\n    stream.on(\"error\", (error) => {\n      console.error(\"SSH stream error:\", error.message)\n    })\n  }\n\n  _initPty() {\n    const newPty = nativePty.open(this.ptyInfo.cols, this.ptyInfo.rows)\n    this.pty = {\n      master_fd: newPty.master,\n      slave_fd: newPty.slave,\n      master: new tty.WriteStream(newPty.master),\n      slave: new tty.ReadStream(newPty.slave),\n    }\n\n    Object.defineProperty(this.pty.slave, \"columns\", {\n      enumerable: true,\n      get: () => this.ptyInfo.cols,\n    })\n    Object.defineProperty(this.pty.slave, \"rows\", {\n      enumerable: true,\n      get: () => this.ptyInfo.rows,\n    })\n\n    this.stream.stdin.pipe(this.pty.master)\n    this.pty.master.pipe(this.stream.stdout)\n  }\n\n  _initTerm() {\n    const term = (this.term = termkit.createTerminal({\n      stdin: this.pty.slave,\n      stdout: this.pty.slave,\n      stderr: this.pty.slave,\n      generic: this.ptyInfo.term,\n      appName: this.title,\n      isSSH: true,\n      isTTY: true,\n    }))\n\n    term.on(\"key\", this.onKey.bind(this))\n    term.windowTitle(this._interpolate(this.title))\n    this.clearScreen()\n  }\n\n  _interpolate(str) {\n    let varRe = /{@(.+?)}/g\n    let vars = {\n      username: this.username,\n    }\n\n    let match\n    while ((match = varRe.exec(str))) {\n      if (vars[match[1]]) {\n        str = str.replace(match[0], vars[match[1]])\n      }\n    }\n\n    return str\n  }\n\n  clearScreen() {\n    this.term.clear()\n    this.prompt()\n  }\n\n  prompt() {\n    const { term } = this\n    term.windowTitle(this._interpolate(this.title))\n    term.bold(this._interpolate(this.promptTxt))\n\n    if (!this.inputActive) {\n      this.inputActive = true\n      this.inputField = term.inputField(\n        {\n          history: this.cmdHistory,\n          autoComplete: Object.keys(this.options.cmdManager.commands),\n          autoCompleteHint: true,\n          autoCompleteMenu: true,\n        },\n        (error, input) => {\n          this.inputActive = false\n          term.nextLine()\n\n          if (error) {\n            return term.error(error.message || error)\n          }\n\n          if (!input) {\n            return this.prompt()\n          }\n          input[0] !== \" \" && this.cmdHistory.push(input)\n\n          if (input === \"exit\") {\n            // This is delayed briefly so the newline can be echoed to the client, creating cleaner output when exiting\n            setTimeout(this.close.bind(this))\n          } else if (input === \"clear\") {\n            this.clearScreen()\n          } else if (input) {\n            this.options.cmdManager\n              .runCmd(input, this.username, this.cmdInterface)\n              .then((output) => {\n                if (typeof output !== \"string\") {\n                  output = JSON.stringify(output, null, \"  \")\n                }\n                this.term(output)\n                this.term.nextLine()\n                this.prompt()\n              })\n              .catch((err) => {\n                if (typeof err !== \"string\") {\n                  err = err.message || JSON.stringify(err, null, \"  \")\n                }\n                this.term.red.error(err)\n                this.term.nextLine()\n                this.prompt()\n              })\n          } else {\n            this.prompt()\n          }\n        },\n      )\n    }\n  }\n}\n\nexport default SSHManager\n","import fs from \"fs\"\nimport scrypt from \"scrypt-kdf\"\n\nclass UserManager {\n  userFile\n  userFileCache = null\n  userFileCreated = false\n\n  constructor(options) {\n    this.userFile = options.userFile\n\n    if (!options.silent) {\n      this.getUsers().then((users) => {\n        const usernames = Object.keys(users)\n        if (!usernames.length) {\n          if (process.env.NODE_ENV === \"production\") {\n            console.warn(\n              `No users have been created and you are running in production mode so you will not be able to login.\\n`,\n            )\n          } else {\n            console.warn(\n              `It seems there are no users and you are not running in production mode so you will not be able to login. This is probably a bug. Please report it!\\n`,\n            )\n          }\n        } else if (usernames.length === 1 && usernames[0] === \"guest\") {\n          console.warn(\n            `[WARN] No users detected. You can login with default user 'guest' and password 'guest' when prompted.\\n` +\n              `This user will be disabled when you create a user account.\\n`,\n          )\n        }\n      })\n    }\n  }\n\n  async getUsers() {\n    if (this.userFileCache) {\n      return this.userFileCache\n    }\n\n    try {\n      if (!this.userFile) {\n        let err = new Error(`No user file specified`)\n        err.code = \"ENOENT\"\n        throw err\n      }\n\n      this.userFileCache = JSON.parse(fs.readFileSync(this.userFile).toString(\"base64\"))\n      this.userFileCreated = true\n      setTimeout(() => {\n        this.userFileCache = null\n      }, 5000)\n\n      return this.userFileCache\n    } catch (err) {\n      if (err.code === \"ENOENT\") {\n        return process.env.NODE_ENV === \"production\"\n          ? {}\n          : {\n              guest: {\n                password:\n                  \"c2NyeXB0AA8AAAAIAAAAAc8D4r96lep3aBQSBeAqf0a+9MX6KyB6zKTF9Nk3ruTPIXrzy8IM7vjSLpIKuVZMNTZZ72CMqKp/PQmnyXmf7wGup1bWBGSwoV5ymA72ZzZg\",\n              },\n            }\n      }\n      throw err\n    }\n  }\n\n  _writeFile(data) {\n    this.userFileCache = null\n    fs.writeFileSync(this.userFile, JSON.stringify(data, null, \"  \"))\n    this.userFileCreated = true\n  }\n\n  async _hashPassword(passwd) {\n    return (await scrypt.kdf(passwd, { logN: 15, r: 8, p: 1 })).toString(\"base64\")\n  }\n\n  async _verifyPassword(actualPasswd, testPasswd) {\n    return scrypt.verify(Buffer.from(actualPasswd, \"base64\"), testPasswd)\n  }\n\n  async createUser(username, password) {\n    if (!this.userFile) {\n      throw new Error(`No user file found. Did you forget to set the 'dataDir' option?`)\n    }\n\n    const users = await this.getUsers()\n    if (users[username]) {\n      throw new Error(`User '${username}' already exists`)\n    }\n\n    if (!this.userFileCreated) {\n      delete users[\"guest\"]\n    }\n\n    users[username] = {\n      password: await this._hashPassword(password),\n    }\n    this._writeFile(users)\n  }\n\n  async deleteUser(username) {\n    if (!this.userFile) {\n      throw new Error(`No user file found. Did you forget to set the 'dataDir' option?`)\n    }\n\n    const users = await this.getUsers()\n    if (!users[username]) {\n      throw new Error(`User '${username}' does not exist`)\n    }\n\n    if (!this.userFileCreated) {\n      throw new Error(`User file has not been created`)\n    }\n\n    delete users[username]\n    this._writeFile(users)\n  }\n\n  async setPassword(username, password) {\n    if (!this.userFile) {\n      throw new Error(`No user file found. Did you forget to set the 'dataDir' option?`)\n    }\n\n    const users = await this.getUsers()\n    users[username].password = await this._hashPassword(password)\n    this._writeFile(users)\n  }\n\n  async getUserData(username) {\n    const users = await this.getUsers()\n    if (!users[username]) {\n      throw new Error(`User '${username}' does not exist`)\n    }\n\n    return users[username]\n  }\n\n  async verifyUser(username, passwd) {\n    const userData = await this.getUserData(username)\n    return this._verifyPassword(userData.password, passwd)\n  }\n}\n\nexport default UserManager\n","import commonUtils from \"../lib/common-utils\"\nimport sourceMapSupport from \"source-map-support\"\n\nexport default Object.assign(\n  {\n    parseCommand(str) {\n      const reg = /\"(.*?)\"|'(.*?)'|`(.*?)`|([^\\s\"]+)/gi\n      const arr = []\n      let match\n\n      do {\n        match = reg.exec(str)\n        if (match !== null) {\n          arr.push(match[1] || match[2] || match[3] || match[4])\n        }\n      } while (match !== null)\n\n      return arr\n    },\n\n    getStack() {\n      let prep = Error.prepareStackTrace\n      let limit = Error.stackTraceLimit\n      Error.prepareStackTrace = (error, trace) => trace.map(sourceMapSupport.wrapCallSite)\n      Error.stackTraceLimit = 30\n\n      let stack = new Error().stack\n      Error.prepareStackTrace = prep\n      Error.stackTraceLimit = limit\n\n      return stack.slice(1)\n    },\n\n    getPromiseObj() {\n      const pobj = {}\n      pobj.promise = new Promise((resolve, reject) => {\n        Object.assign(pobj, {\n          resolve,\n          reject,\n        })\n      })\n      return pobj\n    },\n  },\n  commonUtils,\n)\n","module.exports = require(\"@babel/runtime/helpers/asyncToGenerator\");","module.exports = require(\"@babel/runtime/helpers/classCallCheck\");","module.exports = require(\"@babel/runtime/helpers/createClass\");","module.exports = require(\"@babel/runtime/helpers/defineProperty\");","module.exports = require(\"@babel/runtime/helpers/typeof\");","module.exports = require(\"@babel/runtime/regenerator\");","module.exports = require(\"events\");","module.exports = require(\"keypair\");","module.exports = require(\"lodash\");","module.exports = require(\"minimist\");","module.exports = require(\"node-pty\");","module.exports = require(\"scrypt-kdf\");","module.exports = require(\"socket.io\");","module.exports = require(\"source-map-support\");","module.exports = require(\"ssh2\");","module.exports = require(\"terminal-kit\");","module.exports = require(\"fs\");","module.exports = require(\"fs/promises\");","module.exports = require(\"http\");","module.exports = require(\"os\");","module.exports = require(\"path\");","module.exports = require(\"tty\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import os from \"os\"\nimport fs from \"fs\"\nimport path from \"path\"\nimport { EventEmitter } from \"events\"\nimport _ from \"lodash\"\nimport keypair from \"keypair\"\nimport cycle from \"../lib/cycle\"\nimport bunyanStream from \"./bunyan-stream\"\nimport setupServer from \"./setup-server\"\nimport setupSocket from \"./setup-socket\"\nimport SSHMan from \"./ssh-manager\"\nimport CommandManager from \"./command-manager\"\nimport UserManager from \"./user-manager\"\nimport utils from \"./utils\"\n\nconst NODE_ENV = process.env.NODE_ENV\nconst DEFAULT_PORT = 50500\nconst CONSOLE = _.mapValues(console)\nconst ConsoleEvent = new EventEmitter()\nconst HANDLE_TYPES = [\"log\", \"info\", \"warn\", \"error\", \"dir\"]\n\nlet attachedCount = 0\n\nclass NodeMonkey {\n  msgBuffer = []\n  BUNYAN_STREAM = bunyanStream(this)\n  _attached = false\n  _typeHandlers = {}\n\n  constructor(opts) {\n    const options = (this.options = _.merge(\n      {\n        server: {\n          // You can provide your own server and Node Monkey will use it instead of creating its own.\n          // However, this MUST be the underlying http server instance, not the express/restify/whatever app.\n          server: null,\n\n          host: \"0.0.0.0\",\n          port: DEFAULT_PORT,\n          silent: false,\n          bufferSize: 50,\n          attachOnStart: true,\n\n          // Only takes effect when Node Monkey is attached to the console\n          disableLocalOutput: false,\n        },\n        client: {\n          showCallerInfo: NODE_ENV === \"production\" ? false : true,\n          convertStyles: true,\n        },\n        ssh: {\n          enabled: false,\n          host: \"0.0.0.0\",\n          port: DEFAULT_PORT + 1,\n          title: `Node Monkey on ${os.hostname()}`,\n          prompt: `[Node Monkey] {@username}@${os.hostname()}:`,\n        },\n\n        // Needed for storing things like user files and SSH host keys\n        dataDir: null,\n      },\n      opts,\n    ))\n\n    this._createLocal()\n    this._createRemote()\n    this._setupCmdMan()\n    this._setupUserManager()\n    this._setupServer()\n    this._setupSSH()\n\n    if (options.server.attachOnStart) {\n      this.attachConsole()\n    }\n\n    // TODO: Deprecated. Remove everything after this line by v1.0.0\n    console.local = _.mapValues(this.local, (fn, method) => {\n      const localFn = (...args) => {\n        return fn(...args)\n      }\n      Object.defineProperty(localFn, \"name\", { value: method })\n      return localFn\n    })\n    console.remote = _.mapValues(this.remote, (fn, method) => {\n      const remoteFn = (...args) => {\n        return fn({ callerStackDistance: 2 }, ...args)\n      }\n      Object.defineProperty(remoteFn, \"name\", { value: method })\n      return remoteFn\n    })\n  }\n\n  _getServerProtocol(server) {\n    if (server._events && server._events.tlsClientError) {\n      return \"https\"\n    }\n    return \"http\"\n  }\n\n  getServerPaths() {\n    const resolve = __non_webpack_require__ ? __non_webpack_require__.resolve : resolve\n    const basePath = path.normalize(`${__dirname}/../dist`)\n    const sioBasePath = path.normalize(`${path.dirname(resolve(\"socket.io\"))}/../client-dist`)\n\n    const files = {\n      \"/\": `${basePath}/index.html`,\n      \"/monkey.js\": `${basePath}/monkey.js`,\n      \"/monkey.js.map\": `${basePath}/monkey.js.map`,\n    }\n\n    fs.readdirSync(sioBasePath).forEach(fileName => {\n      files[`/monkey.io-client/${fileName}`] = `${sioBasePath}/${fileName}`\n    })\n\n    return files\n  }\n\n  _displayServerWelcome() {\n    if (!this.options.server.silent) {\n      const server = this.serverApp\n      const address = typeof server.address === \"function\" && server.address()\n      if (server.listening && address) {\n        const proto = this._getServerProtocol(server)\n        const { address, port } = server.address()\n        this.local.log(`Node Monkey listening at ${proto}://${address}:${port}`)\n      } else {\n        server.on(\"listening\", this._displayServerWelcome.bind(this))\n      }\n    }\n  }\n\n  _setupCmdMan() {\n    this._cmdMan = new CommandManager({\n      write: (val, opts) => {\n        console.log(val)\n      },\n      writeLn: (val, opts) => {\n        console.log(val)\n      },\n      error: (val, opts) => {\n        console.error(val)\n      },\n      prompt: (promptTxt, opts, cb) => {\n        if (typeof opts === \"function\") {\n          cb = opts\n          opts = undefined\n        }\n        opts || (opts = {})\n\n        console.warn(\"Prompt not implemented\")\n      },\n    })\n\n    this.addCmd = this._cmdMan.addCmd\n    this.runCmd = this._cmdMan.runCmd\n  }\n\n  _setupUserManager() {\n    const dataDir = this.options.dataDir\n    const userMan = (this.userManager = new UserManager({\n      userFile: dataDir ? `${dataDir}/users.json` : undefined,\n      silent: this.options.server.silent,\n    }))\n\n    this.addCmd(\"showusers\", async (opts, term) => {\n      const users = await userMan.getUsers()\n      term.writeLn(Object.keys(users).join(\"\\n\"))\n    })\n\n    this.addCmd(\"adduser\", (opts, term, done) => {\n      const args = opts.args\n      const username = args._[0]\n\n      if (!username) {\n        term.error(`You must specify a username`)\n        return done()\n      }\n\n      term.prompt(\"Password: \", { hideInput: true }, (error, password) => {\n        term.writeLn()\n        term.prompt(\"Again: \", { hideInput: true }, (error, passwordAgain) => {\n          term.writeLn()\n          if (password === passwordAgain) {\n            userMan\n              .createUser(username, password)\n              .then(() => term.write(`Created user '${username}'`))\n              .catch(term.error)\n              .then(done)\n          } else {\n            term.error(\"Passwords do not match\")\n            done()\n          }\n        })\n      })\n    })\n\n    this.addCmd(\"deluser\", (opts, term, done) => {\n      const args = opts.args\n      const username = args._[0]\n\n      if (!username) {\n        term.error(`You must specify a username`)\n        return done()\n      }\n\n      userMan\n        .deleteUser(username)\n        .then(() => term.write(`Deleted user '${username}'`))\n        .catch(term.error)\n        .then(done)\n    })\n\n    this.addCmd(\"passwd\", (opts, term, done) => {\n      const args = opts.args\n      const user = opts.username\n\n      term.prompt(\"Current password: \", { hideInput: true }, (error, curpwd) => {\n        term.writeLn()\n        userMan.verifyUser(user, curpwd).then((matches) => {\n          if (matches) {\n            term.prompt(\"Password: \", { hideInput: true }, (error, password) => {\n              term.writeLn()\n              term.prompt(\"Again: \", { hideInput: true }, (error, passwordAgain) => {\n                term.writeLn()\n                if (password === passwordAgain) {\n                  userMan\n                    .setPassword(user, password)\n                    .then(() => term.write(`Updated password for ${user}`))\n                    .catch(term.error)\n                    .then(done)\n                } else {\n                  term.error(\"Passwords do not match\")\n                  done()\n                }\n              })\n            })\n          } else {\n            term.error(\"Incorrect password\")\n            done()\n          }\n        })\n      })\n    })\n  }\n\n  _setupServer() {\n    const options = this.options\n    const srvOpts = options.server\n\n    if (srvOpts.server) {\n      this.serverApp = srvOpts.server\n    } else {\n      this.serverApp = setupServer({\n        filePaths: this.getServerPaths(),\n      })\n      this.serverApp.listen(srvOpts.port, srvOpts.host)\n    }\n\n    this._displayServerWelcome()\n    this.remoteClients = setupSocket({\n      server: this.serverApp,\n      cmdManager: this._cmdMan,\n      userManager: this.userManager,\n      onAuth: this._sendMessages.bind(this),\n      clientSettings: options.client,\n    })\n  }\n\n  _setupSSH() {\n    const sshOpts = this.options.ssh\n    if (sshOpts.enabled) {\n      const dataDir = this.options.dataDir\n      if (!dataDir) {\n        throw new Error(`Options 'dataDir' is required to enable SSH`)\n      }\n\n      // Get host keys\n      const files = fs.readdirSync(dataDir)\n      const keyRe = /\\.key$/\n      let hostKeys = []\n      for (let file of files) {\n        if (keyRe.test(file)) {\n          hostKeys.push(`${dataDir}/${file}`)\n        }\n      }\n\n      if (!hostKeys.length) {\n        console.log(\"No SSH host key found. Generating new host key...\")\n        let keys = keypair()\n        fs.writeFileSync(`${dataDir}/rsa.key`, keys.private)\n        fs.writeFileSync(`${dataDir}/rsa.key.pub`, keys.public)\n        hostKeys = [`${dataDir}/rsa.key`]\n      }\n\n      this.SSHMan = new SSHMan({\n        monkey: this,\n        userManager: this.userManager,\n        cmdManager: this._cmdMan,\n        silent: this.options.server.silent,\n        host: sshOpts.host,\n        port: sshOpts.port,\n        title: _.result(sshOpts, \"title\"),\n        prompt: _.result(sshOpts, \"prompt\"),\n        hostKeys,\n      })\n    }\n  }\n\n  // TODO: This whole process of trying to identify the true source of the call is so fucking messy and fragile. Need to think\n  //       of a better way to identify the call source and rewrite all this shitty code handling it right now.\n  _getCallerInfo(callerStackDistance) {\n    if (this.options.client.showCallerInfo) {\n      const stack = utils.getStack().map((frame) => {\n        return {\n          functionName: frame.getFunctionName(),\n          methodName: frame.getMethodName(),\n          fileName: frame.getFileName(),\n          lineNumber: frame.getLineNumber(),\n          columnNumber: frame.getColumnNumber(),\n        }\n      })\n\n      let caller = stack.find((frame, index, stack) => {\n        // We're either looking for a console method call or a bunyan log call. This logic will break down if method names change.\n        const twoBack = stack[index - 2]\n        const sixBack = stack[index - 4]\n        if (twoBack && twoBack.functionName === \"Logger._emit\" && /\\/bunyan\\.js$/.test(twoBack.fileName)) {\n          return true\n        } else if (twoBack && sixBack && twoBack.methodName === \"emit\" && sixBack.methodName === \"_sendMessage\") {\n          return true\n        }\n      })\n\n      if (!caller && typeof callerStackDistance === \"number\") {\n        caller = stack[callerStackDistance]\n      }\n\n      if (caller) {\n        return {\n          caller: caller.functionName || caller.methodName,\n          file: caller.fileName,\n          line: caller.lineNumber,\n          column: caller.columnNumber,\n        }\n      }\n    }\n  }\n\n  _sendMessage(info, callerStackDistance) {\n    this.msgBuffer.push({\n      method: info.method,\n      args: info.args,\n      callerInfo: info.callerInfo || this._getCallerInfo(callerStackDistance + 1),\n    })\n    if (this.msgBuffer.length > this.options.server.bufferSize) {\n      this.msgBuffer.shift()\n    }\n    this._sendMessages()\n  }\n\n  _sendMessages() {\n    const remoteClients = this.remoteClients\n    if (_.size(remoteClients.adapter.rooms.get(\"authed\"))) {\n      _.each(this.msgBuffer, (info) => {\n        remoteClients.to(\"authed\").emit(\"console\", cycle.decycle(info))\n      })\n\n      this.msgBuffer = []\n    }\n  }\n\n  _createLocal() {\n    // NOTE: The console functions here should not be wrapped since these values are used to restore the defaults\n    //       when `detachConsole()` is called.\n    this.local = CONSOLE\n  }\n\n  _createRemote() {\n    let remote = (this.remote = {})\n    HANDLE_TYPES.forEach((method) => {\n      this.remote[method] = (...args) => {\n        const stackdist = args[0] && args[0].callerStackDistance\n        this._sendMessage(\n          {\n            method,\n            args: stackdist ? args.slice(1) : args,\n          },\n          stackdist ? stackdist + 1 : 2,\n        )\n      }\n      Object.defineProperty(remote[method], \"name\", { value: method })\n    })\n  }\n\n  attachConsole(disableLocalOutput) {\n    if (this._attached) {\n      return\n    }\n\n    if (!attachedCount) {\n      // If this function is in the process of handling the log call we will try and prevent potential infinite recursion\n      let handlersActive = 0\n      HANDLE_TYPES.forEach((method) => {\n        console[method] = (...args) => {\n          if (handlersActive) {\n            return this.local[method](...args)\n          }\n\n          ++handlersActive\n          ConsoleEvent.emit(method, ...args)\n          --handlersActive\n        }\n        Object.defineProperty(console[method], \"name\", { value: method })\n      })\n    }\n\n    ++attachedCount\n\n    const serverOptions = this.options.server\n    disableLocalOutput = disableLocalOutput !== undefined ? disableLocalOutput : serverOptions.disableLocalOutput\n\n    _.each(this.remote, (fn, method) => {\n      const handler = (this._typeHandlers[method] = (...args) => {\n        fn({ callerStackDistance: 4 }, ...args)\n\n        if (!disableLocalOutput) {\n          this.local[method](...args)\n        }\n      })\n      Object.defineProperty(handler, \"name\", { value: method })\n\n      ConsoleEvent.on(method, handler)\n    })\n\n    this._attached = true\n  }\n\n  detachConsole() {\n    Object.assign(console, this.local)\n    this._attached = false\n    --attachedCount\n\n    HANDLE_TYPES.forEach((method) => {\n      ConsoleEvent.removeListener(method, this._typeHandlers[method])\n      delete this._typeHandlers[method]\n    })\n  }\n\n  stop() {\n    this.serverApp.close()\n  }\n}\n\nconst instances = {}\nlet lastPort = DEFAULT_PORT - 1\nexport default function createInst(options, name = \"default\") {\n  if (typeof options === \"string\") {\n    name = options\n    options = undefined\n  }\n\n  if (!instances[name]) {\n    options || (options = {})\n    let port = _.get(options, \"server.port\")\n    if (port) {\n      lastPort = +port\n    } else {\n      _.set(options, \"server.port\", ++lastPort)\n      _.set(options, \"ssh.port\", ++lastPort)\n    }\n    instances[name] = new NodeMonkey(options)\n  }\n\n  return instances[name]\n}\n\n// Just exporting in case someone needs to wrap this or access the internals for some reason\nexport { NodeMonkey }\n"],"names":["root","factory","exports","module","define","amd","global","isObject","value","type","invert","obj","inverted","k","hasOwnProperty","origJSON","JSON","decycle","object","replacer","objects","paths","derez","path","i","nu","undefined","Boolean","Date","Number","RegExp","String","indexOf","$ref","push","Array","isArray","forEach","element","Object","keys","name","stringify","retrocycle","$","px","rez","test","eval","item","levelFromName","trace","debug","info","warn","error","fatal","nameFromLevel","utils","inst","write","rec","parse","_sendMessage","method","level","args","msg","CommandInterface","commandManager","writeFn","writeLnFn","errorFn","promptFn","val","opts","console","log","promptTxt","cb","this","writeLn","prompt","CommandManager","cmdName","exec","commands","Error","rawCommand","asUser","io","parsed","cmd","minimist","slice","doneP","result","username","resolve","then","promise","extMap","html","js","json","map","loadedFiles","Map","loadFile","file","has","readFile","set","get","options","filePaths","server","createServer","req","res","filePath","url","contentType","extname","content","setHeader","writeHead","end","socketio","attach","autoUnref","ns","of","on","socket","cmdInterface","emit","clientSettings","creds","userManager","verifyUser","password","join","onAuth","catch","err","cmdId","command","cmdManager","promptId","prompts","pid","response","createCmdInterface","runCmd","output","message","_","handlers","handler","event","SSHManager","host","port","title","silent","Set","assign","ssh2","hostKeys","fs","onClient","bind","monkey","listen","local","address","clients","c","close","client","add","SSHClient","onClose","delete","session","stream","pty","term","ptyInfo","inputActive","cmdHistory","onReady","bold","newline","nextLine","red","inputOpts","hideInput","echo","inputField","style","ctx","accept","reject","once","_resize","_initCmdMan","_initStream","_initPty","_initTerm","matches","data","clearScreen","abort","getInput","length","setTimeout","stdout","isTTY","setRawMode","newPty","nativePty","cols","rows","master_fd","master","slave_fd","slave","tty","defineProperty","enumerable","stdin","pipe","termkit","stderr","generic","appName","isSSH","onKey","windowTitle","_interpolate","str","match","varRe","vars","replace","clear","history","autoComplete","autoCompleteHint","autoCompleteMenu","input","UserManager","userFile","getUsers","users","usernames","process","env","NODE_ENV","userFileCache","code","toString","userFileCreated","guest","passwd","scrypt","logN","r","p","actualPasswd","testPasswd","Buffer","from","_hashPassword","_writeFile","getUserData","userData","_verifyPassword","parseCommand","reg","arr","getStack","prep","prepareStackTrace","limit","stackTraceLimit","sourceMapSupport","stack","getPromiseObj","pobj","Promise","commonUtils","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","prop","prototype","call","Symbol","toStringTag","DEFAULT_PORT","CONSOLE","ConsoleEvent","EventEmitter","HANDLE_TYPES","attachedCount","NodeMonkey","bunyanStream","bufferSize","attachOnStart","disableLocalOutput","showCallerInfo","convertStyles","ssh","enabled","os","dataDir","_createLocal","_createRemote","_setupCmdMan","_setupUserManager","_setupServer","_setupSSH","attachConsole","fn","localFn","remote","remoteFn","callerStackDistance","_events","tlsClientError","__non_webpack_require__","basePath","__dirname","sioBasePath","files","fileName","serverApp","listening","proto","_getServerProtocol","_displayServerWelcome","_cmdMan","addCmd","userMan","done","passwordAgain","createUser","deleteUser","user","curpwd","setPassword","srvOpts","setupServer","getServerPaths","remoteClients","setupSocket","_sendMessages","sshOpts","keyRe","keypair","private","public","SSHMan","frame","functionName","getFunctionName","methodName","getMethodName","getFileName","lineNumber","getLineNumber","columnNumber","getColumnNumber","caller","find","index","twoBack","sixBack","line","column","msgBuffer","callerInfo","_getCallerInfo","shift","adapter","rooms","to","cycle","stackdist","_attached","handlersActive","serverOptions","_typeHandlers","removeListener","instances","lastPort","createInst"],"sourceRoot":""}