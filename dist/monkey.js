!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.NodeMonkey=o():e.NodeMonkey=o()}(self,(function(){return(()=>{"use strict";var __webpack_modules__={484:(e,o,n)=>{function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(o,{Z:()=>t})},91:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(484),origJSON=__webpack_require__.g.JSON,JSON={};const __WEBPACK_DEFAULT_EXPORT__=JSON;"function"!=typeof JSON.decycle&&(JSON.decycle=function(e,o){var n=[],t=[];return function e(r,c){var _,i;return void 0!==o&&(r=o(r)),"object"!==(0,_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__.Z)(r)||null===r||r instanceof Boolean||r instanceof Date||r instanceof Number||r instanceof RegExp||r instanceof String?r:(_=n.indexOf(r))>=0?{$ref:t[_]}:(n.push(r),t.push(c),Array.isArray(r)?(i=[],r.forEach((function(o,n){i[n]=e(o,c+"["+n+"]")}))):(i={},Object.keys(r).forEach((function(o){i[o]=e(r[o],c+"["+JSON.stringify(o)+"]")}))),i)}(e,"$")}),"function"!=typeof JSON.retrocycle&&(JSON.retrocycle=function retrocycle($){var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;return function rez(value){value&&"object"===(0,_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__.Z)(value)&&(Array.isArray(value)?value.forEach((function(element,i){if("object"===(0,_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__.Z)(element)&&null!==element){var path=element.$ref;"string"==typeof path&&px.test(path)?value[i]=eval(path):rez(element)}})):Object.keys(value).forEach((function(name){var item=value[name];if("object"===(0,_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__.Z)(item)&&null!==item){var path=item.$ref;"string"==typeof path&&px.test(path)?value[name]=eval(path):rez(item)}})))}($),$}),JSON=origJSON}},__webpack_module_cache__={};function __webpack_require__(e){var o=__webpack_module_cache__[e];if(void 0!==o)return o.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.d=(e,o)=>{for(var n in o)__webpack_require__.o(o,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o);var __webpack_exports__={};return(()=>{var e=__webpack_require__(484);const o={isObject:function(o){var n=(0,e.Z)(o);return!!o&&("object"==n||"function"==n)},invert:function(e){var o={};for(var n in e)e.hasOwnProperty(n)&&(o[e[n]]=n);return o}},n=Object.assign({getClientHost:function(){for(var e=document.getElementsByTagName("script"),o=/\/monkey\.js/,n=null,t=e.length-1;t>=0;--t)if(o.test(e[t].src)){n=e[t];break}if(n){var r=document.createElement("a");return r.href=n.src,"".concat(r.protocol,"//").concat(r.host)}return"".concat(location.protocol,"//").concat(location.host)},addHeadScript:function(e){var o=document.createElement("script");return o.type="text/javascript",o.src=e,document.getElementsByTagName("head")[0].appendChild(o),o}},o);var t=__webpack_require__(91),r={"[24m":"text-decoration: none","[22m":"font-weight: normal","[1m":"font-weight: bold","[3m":"font-style: italic","[4m":"text-decoration: underline","[23m":"font-style: normal","[39m":"color: ","[37m":"color: white","[90m":"color: grey","[30m":"color: black","[35m":"color: magenta","[33m":"color: yellow","[31m":"color: red","[36m":"color: cyan","[34m":"color: blue","[32m":"color: green"},c=/(\u001b\[.*?m)+/g,_=/(?:^|[^%])%(s|d|i|o|f|c)/g;const i=function(e,o){e.length||e.push("");var t,i=1,a=[];n.isObject(e[0])&&(e.splice(1,0,e[0]),e[0]="%o");for(var l=e[0];t=_.exec(l);)"o"==t[1]&&(e[0]=e[0].replace(t[0],t[0].slice(0,t[0].length-2)+"[39m%o")),i++;if(e.length>i)for(var u=i;u<e.length;u++){var s=e[u],f=void 0;"string"==typeof s?(f=" "+s,e.splice(u,1),u--):f=" [39m%o",e[0]+=f}for(;t=_.exec(e[0]);)a.push(t);var p=0;for(l=e[0];t=c.exec(l);){for(var m=[],d=t[0].split("m"),b=0;b<d.length;b++){var y;(y=r[d[b]+"m"])&&m.push(y)}if(m.length){var v=void 0;for(v=0;v<a.length;v++){var h=a[v];if(t.index<h.index)break}var g=v+1+p;e.splice(g,0,m.join(";")),p++,e[0]=e[0].replace(t[0],"%c")}}return o&&(e[0]+="%c"+o,e.push("color: grey; font-family: Helvetica, Arial, sans-serif")),e};var a=!1,l=window.monkey={cmdId:0,runningCmd:{},connect:null,disconnect:null,init:function(){if(!a)return a=!0,new Promise((function(e,o){n.addHeadScript("".concat(n.getClientHost(),"/socket.io/socket.io.js")).addEventListener("load",(function(){new Promise((function(e,o){var n=io("".concat(location.origin,"/nm"));n.on("connect",(function(){})),n.on("error",(function(e){console.error(e)})),n.on("connect_error",(function(e){console.error(e)})),n.on("reconnect_error",(function(e){console.error(e)})),n.on("connect_timeout",(function(){console.error(new Error("Socket.IO connection timed out"))})),e(n)})).then((function(o){var n=0,r=null,c=i,_={convertStyles:!0};l.client=o,l.connect=o.connect.bind(o),l.disconnect=function(){n=0,r=null,o.disconnect.call(o)};var a=function(){var e,t;n>2?l.disconnect():(r||(e=prompt("Node Monkey username"),t=prompt("Node Monkey password"),r={username:e,password:t}),++n,o.emit("auth",r))};o.on("cmdResponse",(function(e,o,n){if(l.runningCmd[e]){var t=l.runningCmd[e],r=t.resolve,c=t.reject;delete l.runningCmd[e],o?c(o):r(n)}})),o.on("settings",(function(e){Object.assign(_,e),_.convertStyles||(c=function(e,o){return e.concat([o])})})),o.on("auth",a),o.on("authResponse",(function(e,o){e||(r=null,console.warn("Auth failed:",o),a())})),o.on("console",(function(e){var o,n=(e=t.Z.retrocycle(e)).callerInfo;n&&(o=" -- Called from "+n.file+":"+n.line+":"+n.column+(n.caller?"(function "+n.caller+")":"")),"dir"===e.method?(console.dir(e.args[0]),o&&console.log.apply(console,c(["^^^"],o))):console[e.method].apply(console,c(e.args,o))})),o.on("prompt",(function(e,n,t){t||(t={}),o.emit("promptResponse",e,prompt(n))})),e()})).catch(o)}))}));l.connect()},cmd:function(e,o){if(l.client){var n=new Promise((function(o,n){var t=l.cmdId++;l.client.emit("cmd",t,e),l.runningCmd[t]={resolve:o,reject:n}}));return o||n.then((function(e){return null!==e&&console.log(e)})).catch((function(e){null!==e&&(console.error(e),alert(e.message))})),n}console.error("Must be connected to a server to execute a command")}}})(),__webpack_exports__=__webpack_exports__.default,__webpack_exports__})()}));
//# sourceMappingURL=monkey.js.map