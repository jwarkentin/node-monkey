/*! For license information please see monkey.js.LICENSE.txt */
!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.NodeMonkey=n():e.NodeMonkey=n()}(window,(function(){return function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s="./src/client/index.js")}({"./node_modules/@babel/runtime/helpers/typeof.js":function(e,n){function t(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=t=function(e){return typeof e}:e.exports=t=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(n)}e.exports=t},"./node_modules/webpack/buildin/global.js":function(e,n){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},"./src/client/convert-styles.js":function(e,n,t){"use strict";t.r(n);var o=t("./src/client/utils.js"),r={"[24m":"text-decoration: none","[22m":"font-weight: normal","[1m":"font-weight: bold","[3m":"font-style: italic","[4m":"text-decoration: underline","[23m":"font-style: normal","[39m":"color: ","[37m":"color: white","[90m":"color: grey","[30m":"color: black","[35m":"color: magenta","[33m":"color: yellow","[31m":"color: red","[36m":"color: cyan","[34m":"color: blue","[32m":"color: green"},c=/(\u001b\[.*?m)+/g,l=/(?:^|[^%])%(s|d|i|o|f|c)/g;n.default=function(e,n){e.length||e.push("");var t,i=1,u=[];o.default.isObject(e[0])&&(e.splice(1,0,e[0]),e[0]="%o");for(var a=e[0];t=l.exec(a);)"o"==t[1]&&(e[0]=e[0].replace(t[0],t[0].slice(0,t[0].length-2)+"[39m%o")),i++;if(e.length>i)for(var s=i;s<e.length;s++){var f=e[s],_=void 0;"string"==typeof f?(_=" "+f,e.splice(s,1),s--):_=" [39m%o",e[0]+=_}for(;t=l.exec(e[0]);)u.push(t);var p=0;for(a=e[0];t=c.exec(a);){for(var d=[],m=t[0].split("m"),b=0;b<m.length;b++){var y;(y=r[m[b]+"m"])&&d.push(y)}if(d.length){var v=void 0;for(v=0;v<u.length;v++){var h=u[v];if(t.index<h.index)break}var g=v+1+p;e.splice(g,0,d.join(";")),p++,e[0]=e[0].replace(t[0],"%c")}}return n&&(e[0]+="%c"+n,e.push("color: grey; font-family: Helvetica, Arial, sans-serif")),e}},"./src/client/index.js":function(e,n,t){"use strict";t.r(n);var o=t("./src/client/utils.js"),r=t("./src/lib/cycle.js"),c=t("./src/client/convert-styles.js"),l=!1,i=window.monkey={cmdId:0,runningCmd:{},connect:null,disconnect:null,init:function(){if(!l)return l=!0,new Promise((function(e,n){o.default.addHeadScript("".concat(o.default.getClientHost(),"/socket.io/socket.io.js")).addEventListener("load",(function(){new Promise((function(e,n){var t=io("".concat(location.origin,"/nm"));t.on("connect",(function(){})),t.on("error",(function(e){console.error(e)})),t.on("connect_error",(function(e){console.error(e)})),t.on("reconnect_error",(function(e){console.error(e)})),t.on("connect_timeout",(function(){console.error(new Error("Socket.IO connection timed out"))})),e(t)})).then((function(n){var t=0,o=null,l=c.default,u={convertStyles:!0};i.client=n,i.connect=n.connect.bind(n),i.disconnect=function(){t=0,o=null,n.disconnect.call(n)};var a=function(){var e,r;t>2?i.disconnect():(o||(e=prompt("Node Monkey username"),r=prompt("Node Monkey password"),o={username:e,password:r}),++t,n.emit("auth",o))};n.on("cmdResponse",(function(e,n,t){if(i.runningCmd[e]){var o=i.runningCmd[e],r=o.resolve,c=o.reject;delete i.runningCmd[e],n?c(n):r(t)}})),n.on("settings",(function(e){Object.assign(u,e),u.convertStyles||(l=function(e,n){return e.concat([n])})})),n.on("auth",a),n.on("authResponse",(function(e,n){e||(o=null,console.warn("Auth failed:",n),a())})),n.on("console",(function(e){var n,t=(e=r.default.retrocycle(e)).callerInfo;t&&(n=" -- Called from "+t.file+":"+t.line+":"+t.column+(t.caller?"(function "+t.caller+")":"")),"dir"===e.method?(console.dir(e.args[0]),n&&console.log.apply(console,l(["^^^"],n))):console[e.method].apply(console,l(e.args,n))})),n.on("prompt",(function(e,t,o){o||(o={}),n.emit("promptResponse",e,prompt(t))})),e()})).catch(n)}))}));i.connect()},cmd:function(e,n){if(i.client){var t=new Promise((function(n,t){var o=i.cmdId++;i.client.emit("cmd",o,e),i.runningCmd[o]={resolve:n,reject:t}}));return n||t.then((function(e){return null!==e&&console.log(e)})).catch((function(e){null!==e&&(console.error(e),alert(e.message))})),t}console.error("Must be connected to a server to execute a command")}}},"./src/client/utils.js":function(e,n,t){"use strict";t.r(n);var o=t("./src/lib/common-utils.js");n.default=Object.assign({getClientHost:function(){for(var e=document.getElementsByTagName("script"),n=/\/monkey\.js/,t=null,o=e.length-1;o>=0;--o)if(n.test(e[o].src)){t=e[o];break}if(t){var r=document.createElement("a");return r.href=t.src,"".concat(r.protocol,"//").concat(r.host)}return"".concat(location.protocol,"//").concat(location.host)},addHeadScript:function(e){var n=document.createElement("script");return n.type="text/javascript",n.src=e,document.getElementsByTagName("head")[0].appendChild(n),n}},o.default)},"./src/lib/common-utils.js":function(e,n,t){"use strict";t.r(n);var o=t("./node_modules/@babel/runtime/helpers/typeof.js"),r=t.n(o);n.default={isObject:function(e){var n=r()(e);return!!e&&("object"==n||"function"==n)},invert:function(e){var n={};for(var t in e)e.hasOwnProperty(t)&&(n[e[t]]=t);return n}}},"./src/lib/cycle.js":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(global){var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/typeof.js"),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__),origJSON=global.JSON,JSON={};__webpack_exports__.default=JSON,"function"!=typeof JSON.decycle&&(JSON.decycle=function(e,n){var t=[],o=[];return function e(r,c){var l,i;return void 0!==n&&(r=n(r)),"object"!==_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(r)||null===r||r instanceof Boolean||r instanceof Date||r instanceof Number||r instanceof RegExp||r instanceof String?r:(l=t.indexOf(r))>=0?{$ref:o[l]}:(t.push(r),o.push(c),Array.isArray(r)?(i=[],r.forEach((function(n,t){i[t]=e(n,c+"["+t+"]")}))):(i={},Object.keys(r).forEach((function(n){i[n]=e(r[n],c+"["+JSON.stringify(n)+"]")}))),i)}(e,"$")}),"function"!=typeof JSON.retrocycle&&(JSON.retrocycle=function retrocycle($){var px=/^\$(?:\[(?:\d+|\"(?:[^\\\"\u0000-\u001f]|\\([\\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*\")\])*$/;return function rez(value){value&&"object"===_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(value)&&(Array.isArray(value)?value.forEach((function(element,i){if("object"===_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(element)&&null!==element){var path=element.$ref;"string"==typeof path&&px.test(path)?value[i]=eval(path):rez(element)}})):Object.keys(value).forEach((function(name){var item=value[name];if("object"===_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0___default()(item)&&null!==item){var path=item.$ref;"string"==typeof path&&px.test(path)?value[name]=eval(path):rez(item)}})))}($),$}),JSON=origJSON}.call(this,__webpack_require__("./node_modules/webpack/buildin/global.js"))}}).default}));
//# sourceMappingURL=monkey.js.map